using com.apama.adbc.SQLStatement;
using com.apama.adbc.SQLStatementDone;
using com.apama.adbc.ResultSetRow;

monitor Test {
	action onload() {
		send SQLStatement.simple("CREATE TABLE myTable(myColumn int);", new sequence<any>) to "JDBC";

		send SQLStatement.simple("INSERT INTO myTable VALUES(?);", [any(integer, 100)]) to "JDBC";

		send SQLStatement.commandBatch(["INSERT INTO myTable VALUES(200)"//,
		                            //    "INSERT INTO myTable VALUES(300)" // TODO: not working yet; maybe due to autoCommit?
		]) to "JDBC";

		send SQLStatement.parameterBatch("INSERT INTO myTable VALUES(?)", [
		{1:any(integer, 1000)}, 
		{1:any(integer, 2000)},
		{1:any(integer, 3000)}
		]) to "JDBC";

		SQLStatement s := SQLStatement.simple("SELECT * FROM myTable WHERE myColumn > ?", [any(integer, -100)]);
		send s to "JDBC";

		on all ResultSetRow(messageId=s.messageId) as row {
			log row.toString() at INFO;
		}

		on all SQLStatementDone() as sd {
			log sd.toString();
		}
	}
}

